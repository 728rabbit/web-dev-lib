class iweb{constructor(){this.current_language="en",this.language={en:{btn_confirm:"OK",btn_yes:"Yes",btn_no:"No",please_select:"Please Select",type_error:"File type is not allowed.",max_error:"Maximum allowed file size {num}M.",required_error:"This field is required.",password_error:"Password must contain at least 6 characters, including upper/lowercase and numbers (e.g. Abc123).",email_error:"Invalid email address format.",number_error:"Invalid number format.",date_error:"Invalid date format."},zh_hant:{btn_confirm:"確定",btn_yes:"是",btn_no:"否",please_select:"請選擇",type_error:"不允許的檔案類型。",max_error:"檔案大小不能超過{num}M。",required_error:"此項目必須填寫。",password_error:"密碼必須至少包含6個字符，包括大寫/小寫和數字(例如Abc123)。",email_error:"無效的郵件地址格式。",number_error:"無效的數字格式。",date_error:"無效的日期格式。"},zh_hans:{btn_confirm:"确定",btn_yes:"是",btn_no:"否",please_select:"请选择",type_error:"不允许的档案类型。",max_error:"档案大小不能超过{num}M。",required_error:"此项目必须填写。",password_error:"密码必须至少包含6个字符，包括大写/小写和数字(例如Abc123)。",email_error:"无效的邮件地址格式。",number_error:"无效的数字格式。",date_error:"无效的日期格式。"}},this.imd5=new iMD5,this.csrf_token="",this.is_busy=!1,this.idatepicker,this.uploader_options={},this.uploader_files={},this.uploader_files_skip={},this.win_width=0,this.win_scroll_top=0}init(){const e=this;var t,i=document.documentElement.lang?.toLowerCase().replace("-","_"),i=(e.isValue(i)&&e.isValue(e.language[i])&&(e.current_language=i),document.querySelector('meta[name="csrf-token"]')?.content);e.isValue(i)&&(t=location.hostname||"/",e.csrf_token=e.imd5.hash(e.imd5.hash("iweb@"+t)+"@"+i)),e.initBody(),e.initComponent(),e.initForm(),e.win_width=parseInt(document.querySelector("div.iweb-viewer").offsetWidth);const a=(e,t)=>{"function"==typeof window[e]&&window[e](t)};document.addEventListener("DOMContentLoaded",()=>{e.responsive(),a("iweb_common_layout",e.win_width),a("iweb_layout",e.win_width),a("iweb_extra_layout",e.win_width),a("iweb_common_func"),a("iweb_func"),a("iweb_extra_func")}),window.onload=()=>{a("iweb_common_layout_done",e.win_width),a("iweb_layout_done",e.win_width),a("iweb_extra_layout_done",e.win_width),a("iweb_common_func_done"),a("iweb_func_done"),a("iweb_extra_func_done")},window.addEventListener("resize",()=>{e.win_width!==parseInt(document.querySelector("div.iweb-viewer").offsetWidth)&&(e.win_width=parseInt(document.querySelector("div.iweb-viewer").offsetWidth),e.responsive(),a("iweb_common_layout",e.win_width),a("iweb_layout",e.win_width),a("iweb_extra_layout",e.win_width))}),window.addEventListener("scroll",()=>{a("iweb_common_scroll",window.scrollY),a("iweb_scroll",window.scrollY),a("iweb_extra_scroll",window.scrollY)})}initBody(){const a=this;document.body.classList.add("iweb"),a.detectDevice()&&document.body.classList.add("iweb-mobile");var e=Array.from(document.body.children).filter(e=>!["SCRIPT","NOSCRIPT","STYLE"].includes(e.tagName.toUpperCase()));if(0<e.length){const l=document.createElement("div");l.classList.add("iweb-viewer"),e.forEach(e=>l.appendChild(e)),document.body.prepend(l)}document.body.addEventListener("click",e=>{const t=e.target;var i;"a"===t.tagName.toLowerCase()&&(i=t.getAttribute("href"),a.isValue(i)&&!a.isMatch(i,"#")||(e.preventDefault(),t.closest("div.iweb-tips-message")&&a.delayTimer(()=>{t.closest("div.iweb-tips-message").innerHTML="",t.closest("div.iweb-tips-message").classList.remove("error"),t.closest("div.iweb-tips-message").classList.remove("success")}))),t.closest("div.iweb-input-autocomplete")||document.querySelectorAll("div.iweb-input-autocomplete ul.fill-options").forEach(e=>{e.remove()}),t.closest("div.iweb-select")||document.querySelectorAll("div.iweb-select").forEach(e=>e.classList.remove("show"))});const i=["small-font","middle-font","large-font"],t=a.getCookie("iweb_font_size"),s=document.querySelectorAll("a.font-switch");a.isValue(t)&&(document.documentElement.classList.remove(...i),document.documentElement.classList.add(t+"-font"),s.forEach(e=>{e.classList.toggle("current",a.isMatch(e.getAttribute("data-size"),t))})),s.forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),a.delayTimer(()=>{const t=e.target.getAttribute("data-size");a.isValue(t)&&(a.setCookie("iweb_font_size",t),document.documentElement.classList.remove(...i),document.documentElement.classList.add(t+"-font"),s.forEach(e=>{e.classList.toggle("current",a.isMatch(e.getAttribute("data-size"),t))}))})})})}initComponent(){var e=this;e.inputBox(),e.selectBox(),e.checkBox(),e.radioBox(),e.iframe()}inputBox(e,t){const n=this;0<(e=n.isValue(e)?e:document.querySelectorAll('input[type="text"], input[type="password"], input[type="date"], input[type="color"], input[type="tel"], input[type="email"], input[type="number"], input[type="file"], textarea')).length&&e.forEach(e=>{var t,i,a,s;e.closest("div.iweb-input")||(i=n.isMatch(e.getAttribute("data-autocomplete"),1)||n.isMatch(e.getAttribute("data-autocomplete"),!0),(t=document.createElement("div")).classList.add("iweb-input"),t.classList.add(i?"iweb-input-autocomplete":"iweb-input-"+(n.isValue(e.type)?e.type:"text")),e.parentNode.insertBefore(t,e),t.appendChild(e),i?(e.type="hidden",e.classList.add("fill-id"),e.removeAttribute("data-autocomplete"),(i=document.createElement("input")).type="text",i.classList.add("fill-text"),i.style.display="block",i.style.width="100%",i.autocomplete="off",i.addEventListener("input",r=>{r.preventDefault(),n.delayTimer(()=>{const t=r.target;t.closest("div.iweb-input-autocomplete").querySelector("ul.fill-options")?.remove(),t.closest("div.iweb-input-autocomplete").querySelector("small.tips")?.remove();var i={};for(let e=1;e<=5;e++){var a,s=t.closest("div.iweb-input-autocomplete").querySelector("input.fill-id").getAttribute("data-param"+e);n.isValue(s)&&([s,a]=s.split(":"),i[s]=a)}var e=t.value,l={dataType:"json",showBusy:!1,url:t.closest("div.iweb-input-autocomplete").querySelector("input.fill-id").getAttribute("data-url"),values:Object.assign({keywords:e},i)};n.isValue(e)&&n.ajaxPost(l,e=>{if(n.isValue(e)){const a=document.createElement("ul");a.classList.add("fill-options"),(e=Object.values(e)).forEach(e=>{var t=document.createElement("li"),i=document.createElement("a");i.setAttribute("data-id",e.id),i.textContent=e.name,i.addEventListener("click",a=>{a.preventDefault(),n.delayTimer(()=>{var e=a.target,t=e.closest("div.iweb-input-autocomplete").querySelector("input.fill-id"),i=e.closest("div.iweb-input-autocomplete").querySelector("input.fill-text"),i=(t.value=e.getAttribute("data-id"),i.value=e.textContent,i.readOnly=!0,e.closest("div.iweb-input-autocomplete").querySelector("a.fill-reset")?.remove(),document.createElement("a")),e=(i.classList.add("fill-reset"),i.addEventListener("click",a=>{a.preventDefault(),n.delayTimer(()=>{var e=a.target,t=e.closest("div.iweb-input-autocomplete").querySelector("input.fill-id"),i=e.closest("div.iweb-input-autocomplete").querySelector("input.fill-text"),e=e.closest("div.iweb-input-autocomplete").querySelector("a.fill-reset"),i=(t.value="",i.value="",i.readOnly=!1,e.remove(),t.getAttribute("data-rfunc"));"function"==typeof window[i]&&window[i]()})}),document.createElement("i")),e=(e.classList.add("fa","fa-times"),e.style.color="#d73d32",i.appendChild(e),t.closest("div.iweb-input-autocomplete").appendChild(i),t.closest("div.iweb-input-autocomplete").classList.remove("error"),t.closest("div.iweb-input-autocomplete").querySelector("small.tips")?.remove(),t.closest("div.iweb-input-autocomplete").querySelector("ul.fill-options")?.remove(),t.getAttribute("data-sfunc"));"function"==typeof window[e]&&window[e](t.value)})}),t.appendChild(i),a.appendChild(t)}),t.closest("div.iweb-input-autocomplete").appendChild(a)}})})}),t.appendChild(i),s=e.getAttribute("data-default"),e.removeAttribute("data-default"),n.isValue(s)&&(i.setAttribute("data-value",e.value),i.setAttribute("data-default",s),i.value=s,i.readOnly=!0,(s=document.createElement("a")).classList.add("fill-reset"),s.addEventListener("click",a=>{a.preventDefault(),n.delayTimer(()=>{var e=a.target,t=e.closest("div.iweb-input-autocomplete").querySelector("input.fill-id"),i=e.closest("div.iweb-input-autocomplete").querySelector("input.fill-text"),e=e.closest("div.iweb-input-autocomplete").querySelector("a.fill-reset"),i=(t.value="",i.value="",i.readOnly=!1,e.remove(),t.getAttribute("data-rfunc"));"function"==typeof window[i]&&window[i]()})}),(i=document.createElement("i")).classList.add("fa","fa-times"),i.style.color="#d73d32",s.appendChild(i),t.appendChild(s))):n.isMatch(e.type,"password")?((i=document.createElement("button")).type="button",i.classList.add("switch-pwd-type"),i.addEventListener("click",a=>{a.preventDefault(),n.delayTimer(()=>{var e=a.target,t=e.closest("div.iweb-input").querySelector("input"),i=e.closest("div.iweb-input").querySelector("i.show"),e=e.closest("div.iweb-input").querySelector("i.hide");n.isMatch(t.type,"password")?(t.type="text",i.style.display="block",e.style.display="none"):(t.type="password",i.style.display="none",e.style.display="block")})}),(s=document.createElement("i")).classList.add("fa","fa-eye-slash","hide"),s.style.display="block",(a=document.createElement("i")).classList.add("fa","fa-eye","show"),a.style.display="none",i.appendChild(s),i.appendChild(a),t.appendChild(i)):n.isMatch(e.type,"color")&&(e.classList.add("icolorpicker"),e.style.position="relative",e.style.zIndex=1,e.addEventListener("input",i=>{i.preventDefault(),n.delayTimer(()=>{var e=i.target,t=e.closest("div").querySelector("input.icolorcode");/^#[0-9A-F]{6}$/i.test(e.value)&&(t.value=e.value)})}),(s=document.createElement("input")).type="text",s.maxLength=7,s.value=e.value,s.classList.add("icolorcode"),s.style.position="absolute",s.style.top="0px",s.style.left="0px",s.style.right="0px",s.style.bottom="0px",s.style.paddingLeft="42px",s.addEventListener("input",i=>{i.preventDefault(),n.delayTimer(()=>{var e=i.target,t=e.closest("div").querySelector("input.icolorpicker");/^#[0-9A-F]{6}$/i.test(e.value)&&(t.value=e.value)})}),t.appendChild(s)),e.style.display=n.isMatch(e.type,"color")?"inline-block":"block",e.style.width=n.isMatch(e.type,"color")?"36px":"100%",e.autocomplete="off",e.addEventListener("input",t=>{t.preventDefault(),n.delayTimer(()=>{var e=t.target;e.closest("div.iweb-input").classList.remove("error"),e.closest("div.iweb-input").querySelector("small.tips")?.remove()})}))}),n.isValue(n.idatepicker)||(n.idatepicker=new iDatePicker(n.current_language)),n.idatepicker.render('input[type="date"]'),"function"==typeof t&&t()}selectBox(e,t){const u=this;0<(e=u.isValue(e)?e:document.querySelectorAll("select")).length&&e.forEach((e,t)=>{var i=!(!u.isMatch(e.multiple,1)&&!u.isMatch(e.multiple,!0)),a=!(!u.isMatch(e.getAttribute("data-virtual"),1)&&!u.isMatch(e.getAttribute("data-virtual"),!0)),l=!(!u.isMatch(e.getAttribute("data-filter"),1)&&!u.isMatch(e.getAttribute("data-filter"),!0)),r=!(!u.isMatch(e.getAttribute("data-top"),1)&&!u.isMatch(e.getAttribute("data-top"),!0));if(e.removeAttribute("data-virtual"),e.removeAttribute("data-filter"),e.addEventListener("focus",e=>{e.preventDefault(),u.delayTimer(()=>{document.querySelectorAll("div.iweb-select").forEach(e=>{e.classList.remove("show")})})}),e.addEventListener("change",t=>{let i=[],a="";u.delayTimer(()=>{var e=t.target;Array.from(e.querySelectorAll("option")).forEach(e=>{0<e.children.length?Array.from(e.children).forEach(e=>{e.selected&&i.push(e.value.toString())}):e.selected&&i.push(e.value.toString())}),0<e.closest("div.iweb-select").querySelectorAll("div.virtual > div.options ul > li > a").length&&(e.closest("div.iweb-select").querySelectorAll("div.virtual > div.options ul > li > a").forEach(e=>{var t=e.getAttribute("data-value");u.isValue(t)&&(u.isMatch(i.indexOf(t),-1)?e.parentElement.classList.remove("node-selected"):(e.parentElement.classList.add("node-selected"),u.isValue(a)&&(a+=", "),a+=e.textContent))}),u.isValue(a)||(a=u.isValue(e.getAttribute("data-default"))?e.getAttribute("data-default"):u.language[u.current_language].please_select),e.closest("div.iweb-select").querySelector("div.virtual > a.result").innerHTML=a),e.closest("div.iweb-select").classList.remove("error"),e.closest("div.iweb-select").querySelector("small.tips")?.remove()})}),!e.closest("div.iweb-select"))if(a){a=document.createElement("div"),i=(a.classList.add("iweb-select"),i&&a.classList.add("iweb-select-multiple"),document.createElement("div"));i.classList.add("real","hidden"),e.parentNode.insertBefore(i,e),i.appendChild(e),i.parentNode.insertBefore(a,i),a.appendChild(i);let s="";var n,i=document.createElement("div"),o=(i.classList.add("virtual"),document.createElement("a")),d=(o.classList.add("result"),o.textContent=s,o.addEventListener("click",t=>{t.preventDefault(),u.delayTimer(()=>{var e=t.target;const i=e.closest("div.iweb-select").querySelector("div.virtual > div.options > ul");0<i.offsetWidth||0<i.offsetHeight?e.closest("div.iweb-select").classList.remove("show"):e.closest("div.iweb-select").classList.add("show"),document.querySelectorAll("div.iweb-select").forEach(e=>{var t=e.querySelector("div.virtual > div.options > ul");t&&!u.isMatch(t.getAttribute("data-index"),i.getAttribute("data-index"))&&e.classList.remove("show")})})}),i.appendChild(o),document.createElement("div"));d.classList.add("options"),r&&d.classList.add("top");const c=document.createElement("ul");c.setAttribute("data-index","iss"+t),l&&((r=document.createElement("li")).classList.add("filter"),l=e.getAttribute("data-placeholder")||"",(n=document.createElement("input")).id="fkw_"+t,n.type="text",n.placeholder=l.trim(),n.addEventListener("input",t=>{t.preventDefault(),u.delayTimer(()=>{var e=t.target;const i=e.value;u.isValue(i)?e.closest("div.iweb-select").querySelectorAll("div.virtual > div.options ul > li.node > a").forEach(e=>{var t;-1<(e.textContent||e.innerText).toLowerCase().indexOf(i.toLowerCase())?(e.parentElement.classList.remove("hide"),(t=e.closest("li.node-parent"))&&t.classList.remove("hide")):e.parentElement.classList.add("hide")}):e.closest("div.iweb-select").querySelectorAll("div.virtual > div.options ul > li.node").forEach(e=>{e.classList.remove("hide")})})}),r.appendChild(n),c.appendChild(r)),0<e.children.length&&Array.from(e.children).forEach(e=>{if(0<e.children.length){var t=document.createElement("li"),i=(t.classList.add("node","node-parent"),document.createElement("a"));i.textContent=e.getAttribute("label"),t.appendChild(i);const a=document.createElement("ul");Array.from(e.children).forEach(e=>{var t,i;u.isValue(e.value)&&((t=document.createElement("li")).classList.add("node"),(i=document.createElement("a")).setAttribute("data-value",e.value),i.textContent=e.textContent,i.addEventListener("click",l=>{u.delayTimer(()=>{var e=l.target,t=e.closest("div.iweb-select").classList.contains("iweb-select-multiple"),i=e.closest("div.iweb-select").querySelector("div.real > select");let a=[];if(t){i.querySelectorAll("option").forEach(e=>{0<e.children.length?Array.from(e.children).forEach(e=>{e.selected&&a.push(e.value.toString())}):e.selected&&a.push(e.value.toString())});const s=e.getAttribute("data-value").toString();a.includes(s)?a=a.filter(function(e){return e!==s}):a.push(s),i.querySelectorAll("option").forEach(e=>{a.includes(e.value.toString())?e.selected=!0:e.selected=!1})}else e.closest("div.iweb-select").classList.remove("show"),i.value=e.getAttribute("data-value");i.dispatchEvent(new Event("change"))})}),e.selected&&(t.classList.add("node-selected"),t.setAttribute("data-ori","selected"),s=(s+=s?", ":"")+e.textContent),t.appendChild(i),a.appendChild(t))}),t.appendChild(a),c.appendChild(t)}else{i=document.createElement("li"),t=(i.classList.add("node"),document.createElement("a"));t.setAttribute("data-value",e.value),t.textContent=e.textContent,t.addEventListener("click",l=>{u.delayTimer(()=>{var e=l.target,t=e.closest("div.iweb-select").classList.contains("iweb-select-multiple"),i=e.closest("div.iweb-select").querySelector("div.real > select");let a=[];if(t){i.querySelectorAll("option").forEach(e=>{0<e.children.length?Array.from(e.children).forEach(e=>{e.selected&&a.push(e.value.toString())}):e.selected&&a.push(e.value.toString())});const s=e.getAttribute("data-value").toString();a.includes(s)?a=a.filter(function(e){return e!==s}):a.push(s),i.querySelectorAll("option").forEach(e=>{a.includes(e.value.toString())?e.selected=!0:e.selected=!1})}else e.closest("div.iweb-select").classList.remove("show"),i.value=e.getAttribute("data-value");i.dispatchEvent(new Event("change"))})}),e.selected&&(i.classList.add("node-selected"),i.setAttribute("data-ori","selected"),s=(s+=s?", ":"")+e.textContent),i.appendChild(t),c.appendChild(i)}}),u.isValue(s)||(s=u.isValue(e.getAttribute("data-default"))?e.getAttribute("data-default"):u.language[u.current_language].please_select),o.textContent=s,d.appendChild(c),i.appendChild(d),a.appendChild(i)}else{t=document.createElement("div"),l=(t.classList.add("iweb-select"),document.createElement("div"));l.classList.add("real"),e.parentNode.insertBefore(l,e),l.appendChild(e),l.parentNode.insertBefore(t,l),t.appendChild(l)}}),"function"==typeof t&&t()}checkBox(e,t){const a=this;0<(e=a.isValue(e)?e:document.querySelectorAll('input[type="checkbox"]')).length&&e.forEach(e=>{var t,i;e.closest("div.iweb-checkbox")||(t=e.nextElementSibling,(i=document.createElement("div")).classList.add("iweb-checkbox"),e.checked&&i.classList.add("checked"),e.parentNode.insertBefore(i,e),i.appendChild(e),t&&(t.parentNode.insertBefore(i,t),i.appendChild(t)),e.addEventListener("change",t=>{t.preventDefault(),a.delayTimer(()=>{var e=t.target;document.querySelectorAll('input[type="checkbox"][name="'+e.name+'"]').forEach(e=>{e.closest("div.iweb-checkbox").classList.remove("checked"),e.checked&&e.closest("div.iweb-checkbox").classList.add("checked"),e.closest("div.iweb-checkbox").classList.remove("error")}),e.closest("div.iweb-checkbox-set").querySelector("small.tips")?.remove()})}))}),"function"==typeof t&&t()}radioBox(e,t){var a=this;0<(e=a.isValue(e)?e:document.querySelectorAll('input[type="radio"]')).length&&e.forEach(e=>{var t,i;e.closest("div.iweb-raido")||(t=e.nextElementSibling,(i=document.createElement("div")).classList.add("iweb-radio"),e.checked&&i.classList.add("checked"),e.parentNode.insertBefore(i,e),i.appendChild(e),t&&(t.parentNode.insertBefore(i,t),i.appendChild(t)),e.addEventListener("change",i=>{i.preventDefault(),a.delayTimer(()=>{var e=i.target;const t=e.value;document.querySelectorAll('input[type="radio"][name="'+e.name+'"]').forEach(e=>{a.isMatch(e.value,t)?(e.checked=!0,e.closest("div.iweb-radio").classList.add("checked")):(e.checked=!1,e.closest("div.iweb-radio").classList.remove("checked")),e.closest("div.iweb-radio").classList.remove("error")}),e.closest("div.iweb-radio-set").querySelector("small.tips")?.remove()})}))}),"function"==typeof t&&t()}iframe(t="div.iweb-editor",e){this.isValue(t)&&(["iframe","video","object","embed"].forEach(e=>{document.querySelectorAll(t+" "+e).forEach(e=>{var t;e.closest("div.iweb-responsive")||((t=document.createElement("div")).className="iweb-responsive",t.setAttribute("data-width",e.offsetWidth),t.setAttribute("data-height",e.offsetHeight),e.classList.add("vframe"),e.parentNode.insertBefore(t,e),t.appendChild(e))})}),"function"==typeof e)&&e()}responsive(){const l=this;var e=document.querySelectorAll("div.iweb-responsive");0<e.length&&e.forEach(e=>{var t=e.clientWidth;let i=0;var a=e.getAttribute("data-width"),s=e.getAttribute("data-height");0<(i=l.isValue(a)&&l.isValue(s)&&0<s&&0<a?parseInt(t*s/a):i)?e.style.height=i+"px":e.style.height="auto"})}pagination(e){document.querySelectorAll(e).forEach(e=>{new iPagination(e,{mode:e.getAttribute("data-mode")||1,size:e.getAttribute("data-size")||5,total:e.getAttribute("data-totalpage")||1,placeholder:e.getAttribute("data-placeholder")||""})})}initForm(e){const n=this;0<(e=n.isValue(e)?e:document.querySelectorAll('form[data-ajax="1"]')).length&&e.forEach(r=>{const s=!n.isMatch(r.getAttribute("data-showtips"),!1)&&!n.isMatch(r.getAttribute("data-showtips"),0);r.removeAttribute("data-ajax"),r.removeAttribute("data-showtips"),r.method="post",r.autocomplete="off",r.addEventListener("submit",e=>{e.preventDefault(),n.delayTimer(()=>{r.querySelectorAll(".error").forEach(e=>{e.closest("div.iweb-tips-message")||e.classList.remove("error")}),r.querySelectorAll("small.tips").forEach(e=>{e.remove()});let a=!0;var e=r.querySelectorAll("input[data-validation]:not(:disabled), select[data-validation]:not(:disabled), textarea[data-validation]:not(:disabled)"),e=(0<e.length&&e.forEach(e=>{var t,i=e.getAttribute("data-validation").toString().split("|");n.isMatch(e.type,"checkbox")?i.includes("required")&&!e.closest("div.iweb-checkbox-set").querySelector('input[type="checkbox"]:checked')&&(s&&!e.closest("div.iweb-checkbox-set").querySelector("small.tips")&&((t=document.createElement("small")).classList.add("tips"),t.textContent=n.language[n.current_language].required_error,e.closest("div.iweb-checkbox-set").appendChild(t)),e.closest("div.iweb-checkbox").classList.add("error"),a=!1):n.isMatch(e.type,"radio")?i.includes("required")&&!e.closest("div.iweb-radio-set").querySelector('input[type="radio"]:checked')&&(s&&!e.closest("div.iweb-radio-set").querySelector("small.tips")&&((t=document.createElement("small")).classList.add("tips"),t.textContent=n.language[n.current_language].required_error,e.closest("div.iweb-radio-set").appendChild(t)),e.closest("div.iweb-radio").classList.add("error"),a=!1):n.isMatch(e.type,"select-one")||n.isMatch(e.type,"select-multiple")?i.includes("required")&&!n.isValue(e.value)&&(s&&!e.closest("div.iweb-select").querySelector("small.tips")&&((t=document.createElement("small")).classList.add("tips"),t.textContent=n.language[n.current_language].required_error,e.closest("div.iweb-select").appendChild(t)),e.closest("div.iweb-select").classList.add("error"),a=!1):i.includes("required")&&!n.isValue(e.value)?(s&&!e.closest("div.iweb-input").querySelector("small.tips")&&((t=document.createElement("small")).classList.add("tips"),t.textContent=n.language[n.current_language].required_error,e.closest("div.iweb-input").appendChild(t)),e.closest("div.iweb-input").classList.add("error"),a=!1):i.includes("number")&&!n.isNumber(e.value)?(s&&!e.closest("div.iweb-input").querySelector("small.tips")&&((t=document.createElement("small")).classList.add("tips"),t.textContent=n.language[n.current_language].number_error,e.closest("div.iweb-input").appendChild(t)),e.closest("div.iweb-input").classList.add("error"),a=!1):i.includes("email")&&!n.isEmail(e.value)?(s&&!e.closest("div.iweb-input").querySelector("small.tips")&&((t=document.createElement("small")).classList.add("tips"),t.textContent=n.language[n.current_language].email_error,e.closest("div.iweb-input").appendChild(t)),e.closest("div.iweb-input").classList.add("error"),a=!1):i.includes("password")&&!n.isPassword(e.value)?(s&&!e.closest("div.iweb-input").querySelector("small.tips")&&((t=document.createElement("small")).classList.add("tips"),t.textContent=n.language[n.current_language].password_error,e.closest("div.iweb-input").appendChild(t)),e.closest("div.iweb-input").classList.add("error"),a=!1):i.includes("date")&&!n.isDate(e.value)&&(s&&!e.closest("div.iweb-input").querySelector("small.tips")&&((t=document.createElement("small")).classList.add("tips"),t.textContent=n.language[n.current_language].date_error,e.closest("div.iweb-input").appendChild(t)),e.closest("div.iweb-input").classList.add("error"),a=!1)}),r.getAttribute("data-vfunc"));if(a="function"==typeof window[e]?a&&window[e]():a){let s={dataType:"json",showBusy:!0,url:r.action,values:{}};const l=r.querySelector("div.iweb-tips-message");new FormData(r).forEach((t,e)=>{var i=e.match(/(.*)((\[)(.*)(\]))$/i);if(i){var a=i[1];let e=i[4];s.values[a]||(s.values[a]={}),n.isValue(e)||(e=Object.keys(s.values[a]).length+1),s.values[a][e]=t}else s.values[e]=t}),n.ajaxPost(s,function(e){var t,i,a=r.getAttribute("data-cfunc");"function"==typeof window[a]?window[a](e):n.isValue(e.status)&&n.isMatch(e.status,200)?n.isValue(e.url)?window.location.href=e.url:window.location.reload():n.isValue(l)?(l.classList.add("error"),l.innerHTML="",a=document.createElement("div"),(t=document.createElement("a")).className="close",t.textContent="×",(i=document.createElement("span")).textContent=e.message,a.appendChild(t),a.appendChild(i),l.appendChild(a),n.scrollTo(".iweb-tips-message",40)):n.alert(e.message)})}else n.scrollTo(".error",40)})}),r.addEventListener("reset",()=>{n.delayTimer(()=>{var e=r.querySelectorAll("input, select, textarea");0<e.length&&e.forEach(e=>{var t,i;n.isMatch(e.type,"checkbox")||n.isMatch(e.type,"radio")||n.isMatch(e.type,"select-one")||n.isMatch(e.type,"select-multiple")?e.dispatchEvent(new Event("change")):e.closest("div.iweb-input-autocomplete")?(e.closest("div.iweb-input-autocomplete").classList.remove("error"),e.closest("div.iweb-input-autocomplete").querySelector("small.tips")?.remove(),t=e.closest("div.iweb-input-autocomplete").querySelector("input.fill-id"),i=e.closest("div.iweb-input-autocomplete").querySelector("input.fill-text"),e.closest("div.iweb-input-autocomplete").querySelector("a.fill-reset")?.remove(),n.isValue(i.getAttribute("data-value"))&&n.isValue(i.getAttribute("data-default"))&&(t.value=i.getAttribute("data-value"),i.value=i.getAttribute("data-default"),i.readOnly=!1,(t=document.createElement("a")).classList.add("fill-reset"),t.addEventListener("click",a=>{a.preventDefault(),n.delayTimer(()=>{var e=a.target,t=e.closest("div.iweb-input-autocomplete").querySelector("input.fill-id"),i=e.closest("div.iweb-input-autocomplete").querySelector("input.fill-text"),e=e.closest("div.iweb-input-autocomplete").querySelector("a.fill-reset"),i=(t.value="",i.value="",i.readOnly=!1,e.remove(),t.getAttribute("data-rfunc"));"function"==typeof window[i]&&window[i]()})}),(i=document.createElement("i")).classList.add("fa"),i.classList.add("fa-times"),i.style.color="#d73d32",t.appendChild(i),e.closest("div.iweb-input-autocomplete").appendChild(t))):e.dispatchEvent(new Event("input"))})})})})}uploader(s,l){const r=this,n=document.createElement("input");n.type="file",n.multiple=!0,n.onchange=function(){var e,t,i;let a=n.files;7<a.length&&(a=Array.from(a).slice(0,7)),r.uploader_files.selected_files=a,r.uploader_files_skip.selected_files=[-1],r.uploader_options.selected_files={dataType:"json",url:"",values:{},allowed_types:"",max_filesize:64,type_error_message:r.language[r.current_language].type_error,max_error_message:r.language[r.current_language].max_error,btnStartAll:'<i class="fa fa-cloud-upload"></i>',btnClose:'<i class="fa fa-close"></i>',btnStart:'<i class="fa fa-cloud-upload"></i>',btnRemove:'<i class="fa fa-trash"></i>',auto_close:!1},r.isValue(s)&&Object.assign(r.uploader_options.selected_files,s),r.isValue(r.uploader_options.selected_files.allowed_types)&&(r.uploader_options.selected_files.allowed_types=r.uploader_options.selected_files.allowed_types.split("|")),r.uploader_options.selected_files.max_error_message=r.uploader_options.selected_files.max_error_message.replace("{num}",r.uploader_options.selected_files.max_filesize),r.isValue(r.uploader_options.selected_files.url)&&0<r.uploader_files.selected_files.length&&((e=document.createElement("div")).classList.add("action"),(t=document.createElement("button")).type="button",t.classList.add("start-all"),t.innerHTML=r.uploader_options.selected_files.btnStartAll,(i=document.createElement("button")).type="button",i.classList.add("close"),i.innerHTML=r.uploader_options.selected_files.btnClose,e.appendChild(t),e.appendChild(i),(t=document.createElement("div")).classList.add("list"),(i=document.createElement("div")).appendChild(e),i.appendChild(t),r.dialog(i.innerHTML,()=>{r.uploaderPreview(r.uploader_files.selected_files);var e=document.querySelector("div.iweb-info-dialog.uploader > div > div.content > div > div.action > button.start-all"),t=document.querySelector("div.iweb-info-dialog.uploader > div > div.content > div > div.action > button.close");const i=document.querySelector("div.iweb-info-dialog.uploader > div > div.content > div > div.list");e.addEventListener("click",e=>{e.preventDefault(),r.delayTimer(()=>{var e=i.querySelectorAll("div.item");let t=[];e.forEach(function(e){t.push(e.getAttribute("data-index").toString())}),r.uploaderStart(-1,t,t[t.length-1])})}),t.addEventListener("click",e=>{e.preventDefault(),r.delayTimer(()=>{document.querySelector("div.iweb-info-dialog.uploader > div > div.content > a.btn-close").dispatchEvent(new Event("click"))})}),i.querySelectorAll("div.item > button.start").forEach(function(e){e.addEventListener("click",t=>{t.preventDefault(),r.delayTimer(()=>{var e=t.target;r.uploaderStart(e.closest("div.item").getAttribute("data-index"))})})}),i.querySelectorAll("div.item > button.remove").forEach(function(e){e.addEventListener("click",t=>{t.preventDefault(),r.delayTimer(()=>{var e=t.target;r.uploader_files_skip.selected_files.push(e.closest("div.item").getAttribute("data-index").toString()),e.closest("div.item").remove(),0===i.querySelectorAll("div.item").length&&document.querySelector("div.iweb-info-dialog.uploader > div > div.content > a.btn-close").dispatchEvent(new Event("click"))})})})},function(){"function"==typeof l&&l()},"uploader"))},n.click()}uploaderArea(s,l,r){const n=this,o=document.getElementById(s);var e=o.parentElement;e.id=s+"-iweb-files-dropzone",e.classList.add("iweb-files-dropzone");const d=document.createElement("div");d.className="iweb-files-uploader",e.appendChild(d),o.removeAttribute("name"),o.multiple=!0,o.onchange=function(){if(n.uploader_files["inline_selected_files_"+n.imd5.hash(s)]=o.files,n.uploader_files_skip["inline_selected_files_"+n.imd5.hash(s)]=[-1],n.uploader_options["inline_selected_files_"+n.imd5.hash(s)]={dataType:"json",url:"",values:{},allowed_types:"",max_filesize:64,type_error_message:n.language[n.current_language].type_error,max_error_message:n.language[n.current_language].max_error,btnStartAll:'<i class="fa fa-cloud-upload"></i>',btnClose:'<i class="fa fa-close"></i>',btnStart:'<i class="fa fa-cloud-upload"></i>',btnRemove:'<i class="fa fa-trash"></i>',auto_close:!0},n.isValue(l)&&(n.uploader_options["inline_selected_files_"+n.imd5.hash(s)]=Object.assign(n.uploader_options["inline_selected_files_"+n.imd5.hash(s)],l)),n.isValue(n.uploader_options["inline_selected_files_"+n.imd5.hash(s)].allowed_types)&&(n.uploader_options["inline_selected_files_"+n.imd5.hash(s)].allowed_types=n.uploader_options["inline_selected_files_"+n.imd5.hash(s)].allowed_types.split("|")),n.uploader_options["inline_selected_files_"+n.imd5.hash(s)].max_error_message=n.uploader_options["inline_selected_files_"+n.imd5.hash(s)].max_error_message.replace("{num}",n.uploader_options["inline_selected_files_"+n.imd5.hash(s)].max_filesize),n.isValue(n.uploader_options["inline_selected_files_"+n.imd5.hash(s)].url)&&0<o.files.length){var e=document.createElement("div"),t=(e.className="action",document.createElement("button")),i=(t.className="start-all",t.type="button",t.title="Start All",t.innerHTML='<i class="fa fa-cloud-upload"></i>',e.appendChild(t),document.createElement("button"));i.className="close",i.type="button",i.innerHTML='<i class="fa fa-close"></i>',e.appendChild(i),d.appendChild(e);const a=document.createElement("div");a.classList.add("list"),d.appendChild(a),n.uploaderPreview(n.uploader_files["inline_selected_files_"+n.imd5.hash(s)],0,s),t.addEventListener("click",e=>{e.preventDefault(),n.delayTimer(()=>{var e=a.querySelectorAll("div.item");let t=[];e.forEach(function(e){t.push(e.getAttribute("data-index").toString())}),n.uploaderStart(-1,t,t[t.length-1],s)})}),i.addEventListener("click",e=>{e.preventDefault(),n.delayTimer(()=>{d.innerHTML="",o.value="","function"==typeof r&&r()})}),a.querySelectorAll("div.item > button.start").forEach(function(e){e.addEventListener("click",t=>{t.preventDefault(),n.delayTimer(()=>{var e=t.target;n.uploaderStart(e.closest("div.item").getAttribute("data-index"),null,null,s)})})}),a.querySelectorAll("div.item > button.remove").forEach(function(e){e.addEventListener("click",t=>{t.preventDefault(),n.delayTimer(()=>{var e=t.target;n.uploader_files_skip["inline_selected_files_"+n.imd5.hash(s)].push(e.closest("div.item").getAttribute("data-index").toString()),e.closest("div.item").remove(),0===a.querySelectorAll("div.item").length&&(d.innerHTML="",o.value="")})})})}}}uploaderPreview(t,i=0,a){var s=this;if(!(i>=t.length)){var l=t[i],r=l.name.split(".").pop().toLowerCase();let e=!0;var n=document.createElement("div");n.classList.add("item"),n.setAttribute("data-index",i);const p=document.createElement("div"),h=(p.classList.add("photo"),document.createElement("img"));/^(.*)(.jpg|.jpeg|.gif|.png|.bmp)$/.test(l.name.toLowerCase())&&"undefined"!=typeof FileReader?((o=new FileReader).onload=function(e){h.src=e.target.result,p.appendChild(h)},o.readAsDataURL(l)):p.innerHTML={pdf:'<i class="fa fa-file-pdf-o" style="color:#ef4130;"></i>',doc:'<i class="fa fa-file-word-o" style="color:#5091cd;"></i>',docx:'<i class="fa fa-file-word-o" style="color:#5091cd;"></i>',xls:'<i class="fa fa-file-excel-o" style="color:#66cdaa;"></i>',xlsx:'<i class="fa fa-file-excel-o" style="color:#66cdaa;"></i>',ppt:'<i class="fa fa-file-powerpoint-o" style="color:#f7b002;"></i>',pptx:'<i class="fa fa-file-powerpoint-o" style="color:#f7b002;"></i>',txt:'<i class="fa fa-file-text-o"></i>',avi:'<i class="fa fa-file-video-o" style="color:#5091cd;"></i>',mov:'<i class="fa fa-file-video-o" style="color:#5091cd;"></i>',mp4:'<i class="fa fa-file-video-o" style="color:#5091cd;"></i>',ogg:'<i class="fa fa-file-video-o" style="color:#5091cd;"></i>',wmv:'<i class="fa fa-file-video-o" style="color:#5091cd;"></i>',webm:'<i class="fa fa-file-video-o" style="color:#5091cd;"></i>',mp3:'<i class="fa fa-file-audio-o" style="color:#66cdaa;"></i>',wav:'<i class="fa fa-file-audio-o" style="color:#66cdaa;"></i>',rar:'<i class="fa fa-file-zip-o" style="color:#f7b002;"></i>',zip:'<i class="fa fa-file-zip-o" style="color:#f7b002;"></i>'}[r]||'<i class="fa fa-file-code-o"></i>',n.appendChild(p);var o=document.createElement("div"),d=(o.classList.add("info"),document.createElement("div")),d=(d.classList.add("title"),d.textContent=l.name,o.appendChild(d),document.createElement("div")),d=(d.classList.add("size"),d.textContent=s.formatBytes(l.size,0),o.appendChild(d),s.isValue(a)?"inline_selected_files_"+s.imd5.hash(a):"selected_files"),d=s.uploader_options[d],c=d.allowed_types||[],u=1024*d.max_filesize*1024,u=(c.length&&c.indexOf(r)<0?((c=document.createElement("div")).classList.add("tips"),c.innerHTML="<small>"+d.type_error_message+"</small>",o.appendChild(c),e=!1):l.size>u?((r=document.createElement("div")).classList.add("tips"),r.innerHTML="<small>"+d.max_error_message+"</small>",o.appendChild(r),e=!1):((c=document.createElement("div")).classList.add("progress-bar"),c.innerHTML='<div class="percent"></div>',o.appendChild(c)),n.appendChild(o),e&&((l=document.createElement("button")).type="button",l.classList.add("start"),l.innerHTML='<i class="fa fa-cloud-upload"></i>',n.appendChild(l)),document.createElement("button")),d=(u.type="button",u.classList.add("remove"),u.innerHTML='<i class="fa fa-trash"></i>',n.appendChild(u),s.isValue(a)?"#"+a+"-iweb-files-dropzone > div.iweb-files-uploader > div.list":"div.iweb-info-dialog.uploader > div > div.content > div > div.list");document.querySelector(d).appendChild(n),s.uploaderPreview(t,i+1,a)}}uploaderStart(a,s,l,r){const n=this;let t="selected_files";n.isValue(r)&&(t="inline_selected_files_"+n.imd5.hash(r));const o=()=>{var e=n.isValue(r)?document.querySelector("#"+r+"-iweb-files-dropzone"):document.querySelector("div.iweb-info-dialog.uploader");e&&(0==e.querySelectorAll("div.list > div.item > button.start").length&&(e.querySelector("div.action > button.start-all")?.remove(),n.uploader_options[t].auto_close)&&e.querySelector("div.action > button.close").dispatchEvent(new Event("click")),e.classList.remove("busy"))},d=n.isValue(r)?document.querySelector("#"+r+"-iweb-files-dropzone"):document.querySelector("div.iweb-info-dialog.uploader");d.classList.add("busy");let c=!0;if(n.isValue(s)?a+=1:(s=[a],l=a,c=!1),parseInt(a)<=parseInt(l))if(s.includes(a.toString()))if(n.isValue(n.uploader_files[t])&&!n.uploader_files_skip[t].includes(a.toString())){n.uploader_files_skip[t].push(a.toString());var u=n.uploader_files[t],i=u[a].name.split(".").pop().toLowerCase();let e=!0;if(e=n.isValue(n.uploader_options[t].allowed_types)&&!n.uploader_options[t].allowed_types.includes(i.toString())||u[a].size>1024*n.uploader_options[t].max_filesize*1024?!1:e){let i={dataType:"json",showBusy:!1,url:n.uploader_options[t].url,values:{}};const p=new FormData;p.append("page_action","file_upload"),n.isValue(n.uploader_options[t].values)&&Object.entries(n.uploader_options[t].values).forEach(([e,t])=>{p.append(e,t)}),p.append("myfile",u[a],u[a].name),p.forEach((e,t)=>{i.values[t]=e}),n.ajaxPost(i,function(e){var t=d.querySelector('div.list > div.item[data-index="'+a+'"]'),e=(t.querySelector("div.info > div.progress-bar")?.remove(),e.message||e),t=t.querySelector("div.info"),i=document.createElement("div");i.classList.add("tips"),i.innerHTML="<small>"+e+"</small>",t.appendChild(i),c?n.uploaderStart(a,s,l,r):o()},null,function(e){var t=d.querySelector('div.list > div.item[data-index="'+a+'"]'),t=(t.querySelector("button.start")?.remove(),t.querySelector("button.remove")?.remove(),t.querySelector("div.info > div.progress-bar > div.percent"));t&&(t.style.width=e+"%")})}else{i=d.querySelector('div.list > div.item[data-index="'+a+'"]');i.querySelector("button.start")?.remove(),i.querySelector("button.remove")?.remove(),c?n.uploaderStart(a,s,l,r):o()}}else c?n.uploaderStart(a,s,l,r):o();else c?n.uploaderStart(a,s,l,r):o();else o()}alert(e="",i,t){if(!(0<document.querySelectorAll("div.iweb-alert-dialog").length)){var a=document.createElement("div"),t=(a.classList.add("iweb-alert-dialog"),this.isValue(t)&&a.classList.add(t),document.createElement("div"));const r=document.createElement("div");r.classList.add("content"),r.style.transition="transform 0.5s ease, opacity 0.5s ease",r.style.transform="translateY(-320%)",r.style.opacity="0";var s=document.createElement("div"),e=(s.innerHTML=e,document.createElement("button")),l=(e.classList.add("btn"),e.classList.add("btn-close"),e.textContent=this.language[this.current_language].btn_confirm,e.addEventListener("click",e=>{e.preventDefault();const t=e.target;r.style.transform="translateY(-320%)",r.style.transform="0",r.addEventListener("transitionend",()=>{t.closest("div.iweb-alert-dialog").remove(),0===document.querySelectorAll("div.iweb-alert-dialog").length&&0===document.querySelectorAll("div.iweb-info-dialog").length&&document.body.classList.remove("iweb-disable-scroll"),"function"==typeof i&&i()},{once:!0})}),document.querySelector("div.iweb-viewer"));t.appendChild(r),r.appendChild(s),r.appendChild(e),a.appendChild(t),l.insertBefore(a,l.firstChild),document.body.classList.add("iweb-disable-scroll"),this.delayTimer(()=>{r.style.transform="translateY(0)",r.style.opacity="1"})}}confirm(e="",i,t){if(!(0<document.querySelectorAll("div.iweb-alert-dialog").length)){var a=this,s=document.createElement("div"),t=(s.classList.add("iweb-alert-dialog"),a.isValue(t)&&s.classList.add(t),document.createElement("div"));const o=document.createElement("div");o.classList.add("content"),o.style.transition="transform 0.5s ease, opacity 0.5s ease",o.style.transform="translateY(-320%)",o.style.opacity="0";var l=document.createElement("div"),e=(l.innerHTML=e,document.createElement("button")),r=(e.classList.add("btn"),e.classList.add("btn-yes"),e.textContent=a.language[a.current_language].btn_yes,e.addEventListener("click",e=>{const t=e.target;o.style.transform="translateY(-320%)",o.style.transform="0",o.addEventListener("transitionend",()=>{t.closest("div.iweb-alert-dialog").remove(),0===document.querySelectorAll("div.iweb-alert-dialog").length&&0===document.querySelectorAll("div.iweb-info-dialog").length&&document.body.classList.remove("iweb-disable-scroll"),"function"==typeof i&&i(!0)},{once:!0})}),document.createElement("button")),n=(r.classList.add("btn"),r.classList.add("btn-no"),r.textContent=a.language[a.current_language].btn_no,r.addEventListener("click",e=>{const t=e.target;o.style.transform="translateY(-320%)",o.style.transform="0",o.addEventListener("transitionend",()=>{t.closest("div.iweb-alert-dialog").remove(),0===document.querySelectorAll("div.iweb-alert-dialog").length&&0===document.querySelectorAll("div.iweb-info-dialog").length&&document.body.classList.remove("iweb-disable-scroll"),"function"==typeof i&&i(!1)},{once:!0})}),document.querySelector("div.iweb-viewer"));t.appendChild(o),o.appendChild(l),o.appendChild(e),o.appendChild(r),s.appendChild(t),n.insertBefore(s,n.firstChild),document.body.classList.add("iweb-disable-scroll"),a.delayTimer(()=>{o.style.transform="translateY(0)",o.style.opacity="1"})}}dialog(e,t,i,a){if(!document.querySelector("div.iweb-info-dialog")){var s=document.createElement("div"),a=(s.classList.add("iweb-info-dialog"),this.isValue(a)&&s.classList.add(a),document.createElement("div"));a.addEventListener("click",e=>{e=e.target;e.closest("div.iweb-info-dialog")&&!e.closest("div.content")&&e.closest("div.iweb-info-dialog").querySelector("a.btn-close").dispatchEvent(new Event("click"))});const n=document.createElement("div");n.classList.add("content"),n.style.transition="transform 0.5s ease, opacity 0.5s ease",n.style.transform="translateY(-320%)",n.style.opacity="0";var l=document.createElement("div"),e=("string"==typeof e?l.innerHTML=e:l.appendChild(e),document.createElement("a")),r=(e.classList.add("btn"),e.classList.add("btn-close"),e.addEventListener("click",e=>{const t=e.target;n.style.transform="translateY(-320%)",n.style.transform="0",n.addEventListener("transitionend",()=>{t.closest("div.iweb-info-dialog").remove(),0===document.querySelectorAll("div.iweb-alert-dialog").length&&0===document.querySelectorAll("div.iweb-info-dialog").length&&document.body.classList.remove("iweb-disable-scroll"),"function"==typeof i&&i()},{once:!0})}),document.querySelector("div.iweb-viewer"));a.appendChild(n),n.appendChild(l),n.appendChild(e),s.appendChild(a),r.insertBefore(s,r.firstChild),document.body.classList.add("iweb-disable-scroll"),this.initComponent(),this.initForm(),"function"==typeof t&&t(),this.delayTimer(()=>{n.style.transform="translateY(0)",n.style.opacity="1"})}}ajaxPost(t,i,e,a){const s=this;if(t=Object.assign({dataType:"json",showBusy:!0,url:"",values:{}},t),!s.is_busy&&s.isValue(t.url)){var l=s.toDateTime(),r=new FormData;if(r.append("itoken",window.btoa(s.imd5.hash(s.csrf_token+"#dt"+l)+"%"+l)),t.values)for(var n in t.values){var o=t.values[n];if("object"!=typeof o||(o instanceof File||o instanceof FileList))r.append(n,o);else for(var d in o)r.append(n+"["+d+"]",o[d])}const c=()=>{s.is_busy=!1,(s.isMatch(t.showBusy,!0)||s.isMatch(t.showBusy,1)||s.isMatch(t.showBusy,2))&&!s.isMatch(t.showBusy,2)&&s.showBusy(!1),"function"==typeof e&&e()};try{(s.isMatch(t.showBusy,!0)||s.isMatch(t.showBusy,1)||s.isMatch(t.showBusy,2))&&s.showBusy(!0,70),s.is_busy=!0;const u=new XMLHttpRequest;u.open("POST",t.url,!0),u.upload.onprogress=function(e){e.lengthComputable&&(e=Math.ceil(e.loaded/e.total*100),"function"==typeof a)&&a(e)},u.onload=function(){if(c(),!(200<=u.status&&u.status<300))throw new Error(u.statusText);{let e;switch(t.dataType.toLowerCase()){case"json":e=JSON.parse(u.responseText);break;case"blob":e=u.response;break;default:e=u.responseText}"function"==typeof i&&i(e)}},u.onerror=function(){c(),alert("Unstable network, please check your network connection.")},u.onabort=function(){c(),alert("Request aborted.")},u.ontimeout=function(){c(),alert("Request timed out.")},u.send(r)}catch(e){c();let t=e.message;return e.message.includes("NetworkError")?t="Unstable network, please check your network connection.":e.message.includes("404")?t="The requested page not found.":e.message.includes("500")&&(t="Internal Server Error."),alert(t),!1}}}isValue(e){return null!=e&&(e instanceof HTMLElement?""!==e.outerHTML.trim():"object"==typeof e?Array.isArray(e)?0<e.length:0<Object.keys(e).length:""!==e.toString().trim())}isMatch(e,t,i=!1){return!(!this.isValue(e)||!this.isValue(t))&&(e=e.toString().trim(),t=t.toString().trim(),i?e===t:e.toLowerCase()===t.toLowerCase())}isNumber(e,t=!1){t=t?/^[0-9]+$/:/(^((-)?[1-9]{1}\d{0,2}|0\.|0$))(((\d)+)?)(((\.)(\d+))?)$/;return!!this.isValue(e)&&t.test(e)}isEmail(e){return!!this.isValue(e)&&/^([A-Za-z0-9_\-\.])+@([A-Za-z0-9_\-\.])+\.[A-Za-z]{2,}$/.test(e)}isPassword(e){return!!this.isValue(e)&&/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}$/.test(e)}isDate(t,i="Y-m-d"){if(this.isValue(t)&&(this.isMatch(i,"Y-m-d")||(t=t.split("/").reverse().join("-")),/^(\d{4})(\-)(\d{2})(\-)(\d{2})$/.test(t))){let e=!0;var i=t.split("-"),a=parseInt(i[2]),s=parseInt(i[1]),i=parseInt(i[0]);return(isNaN(a)||isNaN(s)||isNaN(i)||i<=0||s<=0||12<s||a<=0||[1,3,5,7,8,10,12].includes(s)&&31<a||[4,6,9,11].includes(s)&&30<a||2==s&&((s=i%4==0&&i%100!=0||i%400==0)&&29<a||!s&&28<a))&&(e=!1),new Date(t)instanceof Date&&e}return!1}toNumber(t,e,i){if(t=t.toString().replace(/[^\d|\-|\.]/g,""),this.isNumber(t)){if(this.isNumber(i)&&0<parseInt(i)){var a=Math.pow(10,i);t*=a;let e=(t=(Math.round(t)/a).toString()).indexOf(".");for(e<0&&(e=t.length,t+=".");t.length<=e+i;)t+="0"}return this.isMatch(e,!0)?t.toString().replace(/(\d)(?=(\d{3})+\b)/g,"$1,"):t}return 0}toDateTime(e,t="Y-m-d H:i:s"){var e=this.isValue(e)?new Date(e):new Date,i=e.getFullYear();let a=e.getMonth()+1,s=e.getDate(),l=e.getHours(),r=e.getMinutes(),n=e.getSeconds(),o=(1==a.toString().length&&(a="0"+a),1==s.toString().length&&(s="0"+s),1==l.toString().length&&(l="0"+l),1==r.toString().length&&(r="0"+r),1==n.toString().length&&(n="0"+n),"");switch(t){case"Y-m-d H:i:s":o=i+"-"+a+"-"+s+" "+l+":"+r+":"+n;break;case"Y-m-d H:i":o=i+"-"+a+"-"+s+" "+l+":"+r;break;case"d/m/Y H:i:s":o=s+"/"+a+"/"+i+" "+l+":"+r+":"+n;break;case"d/m/Y H:i":o=s+"/"+a+"/"+i+" "+l+":"+r;break;case"Y-m-d":o=i+"-"+a+"-"+s;break;case"d/m/Y":o=s+"/"+a+"/"+i;break;case"H:i:s":o=l+":"+r+":"+n;break;case"H:i":o=l+":"+r;break;case"Y":o=i;break;case"m":o=a;break;case"d":o=s;break;case"h":o=l;break;case"i":o=r;break;case"s":o=n}return o}setCookie(e,t,i=14){var a;navigator.cookieEnabled?this.isValue(e)&&((a=new Date).setTime(a.getTime()+24*i*60*60*1e3),i="expires="+a.toUTCString(),document.cookie=e+"="+t+";"+i+";path=/"):alert("Cookies Blocked or not supported by your browser.")}getCookie(e){if(navigator.cookieEnabled){if(this.isValue(e)){var t=e+"=",i=document.cookie.split(";");for(let e=0;e<i.length;e++){var a=i[e].trim();if(0===a.indexOf(t))return a.substring(t.length,a.length)}}}else alert("Cookies Blocked or not supported by your browser.");return""}delayTimer(e,t=100){"function"==typeof e&&setTimeout(()=>{e()},t)}showBusy(t,i){var a=this;if(a.isMatch(t,1)||a.isMatch(t,!0)){if(0===document.querySelectorAll("div.iweb-processing").length){let e=1;a.isNumber(i,!0)&&(e=Math.round(parseInt(i)/100*100)/100);var t=document.createElement("div"),s=(t.className="iweb-processing",a.isNumber(i,!0)&&(t.style.background="rgba(255,255,255,"+e+")"),document.createElement("div")),l=(s.className="loading",document.createElementNS("http://www.w3.org/2000/svg","svg")),r=(l.setAttribute("width","48px"),l.setAttribute("height","48px"),l.setAttribute("viewBox","0 0 100 100"),l.setAttribute("preserveAspectRatio","xMidYMid"),document.createElementNS("http://www.w3.org/2000/svg","circle")),n=(r.setAttribute("cx","50"),r.setAttribute("cy","50"),r.setAttribute("fill","none"),r.setAttribute("stroke","#dddddd"),r.setAttribute("stroke-width","10"),r.setAttribute("r","36"),r.setAttribute("stroke-dasharray","169.64600329384882 58.548667764616276"),document.createElementNS("http://www.w3.org/2000/svg","animateTransform"));n.setAttribute("attributeName","transform"),n.setAttribute("type","rotate"),n.setAttribute("repeatCount","indefinite"),n.setAttribute("dur","1s"),n.setAttribute("values","0 50 50;360 50 50"),n.setAttribute("keyTimes","0;1"),r.appendChild(n),l.appendChild(r),s.appendChild(l),t.appendChild(s),document.body.insertBefore(t,document.body.firstChild)}}else{let e=0;a.isNumber(i,!0)&&(e=parseInt(i)),a.delayTimer(()=>{document.querySelectorAll("div.iweb-processing").forEach(e=>{e.remove()})},e)}}scrollTo(e,t,i){let a=0;t=this.isValue(t)?parseInt(t):0;e=document.querySelector(e);e&&(a=Math.max(0,parseInt(e.getBoundingClientRect().top+window.pageYOffset)-t)),window.scrollTo({top:a,behavior:"smooth"}),this.delayTimer(()=>{Math.abs(window.pageYOffset-a)<=1&&"function"==typeof i&&i()})}formatBytes(e,t){var i;return e?(t=t<0?0:t,i=Math.floor(Math.log(e)/Math.log(1024)),parseFloat((e/Math.pow(1024,i)).toFixed(t))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][i]):"0 Bytes"}detectDevice(e){var t=function(){return navigator.userAgent.match(/Android/i)},i=function(){return navigator.userAgent.match(/BlackBerry/i)},a=function(){return navigator.userAgent.match(/Mac|iPhone|iPad|iPod/i)},s=function(){return navigator.userAgent.match(/Opera Mini/i)},l=function(){return navigator.userAgent.match(/IEMobile/i)};switch(e){case"android":return t();case"blackberry":return i();case"ios":return a();case"opera":return s();case"windows":return l();default:return t()||i()||a()||s()||l()}}}class iMD5{constructor(){this.hex_chr="0123456789abcdef".split("")}add32(e,t){return e+t&4294967295}cmn(e,t,i,a,s,l){return this.add32(this.add32(this.add32(t,e),this.add32(a,l))<<s|this.add32(this.add32(t,e),this.add32(a,l))>>>32-s,i)}ff(e,t,i,a,s,l,r){return this.cmn(t&i|~t&a,e,t,s,l,r)}gg(e,t,i,a,s,l,r){return this.cmn(t&a|i&~a,e,t,s,l,r)}hh(e,t,i,a,s,l,r){return this.cmn(t^i^a,e,t,s,l,r)}ii(e,t,i,a,s,l,r){return this.cmn(i^(t|~a),e,t,s,l,r)}md5cycle(e,t){var i=e[0],i=this.ff(i,l=e[1],s=e[2],a=e[3],t[0],7,-680876936),a=this.ff(a,i,l,s,t[1],12,-389564586),s=this.ff(s,a,i,l,t[2],17,606105819),l=this.ff(l,s,a,i,t[3],22,-1044525330);i=this.ff(i,l,s,a,t[4],7,-176418897),a=this.ff(a,i,l,s,t[5],12,1200080426),s=this.ff(s,a,i,l,t[6],17,-1473231341),l=this.ff(l,s,a,i,t[7],22,-45705983),i=this.ff(i,l,s,a,t[8],7,1770035416),a=this.ff(a,i,l,s,t[9],12,-1958414417),s=this.ff(s,a,i,l,t[10],17,-42063),l=this.ff(l,s,a,i,t[11],22,-1990404162),i=this.ff(i,l,s,a,t[12],7,1804603682),a=this.ff(a,i,l,s,t[13],12,-40341101),s=this.ff(s,a,i,l,t[14],17,-1502002290),l=this.ff(l,s,a,i,t[15],22,1236535329),i=this.gg(i,l,s,a,t[1],5,-165796510),a=this.gg(a,i,l,s,t[6],9,-1069501632),s=this.gg(s,a,i,l,t[11],14,643717713),l=this.gg(l,s,a,i,t[0],20,-373897302),i=this.gg(i,l,s,a,t[5],5,-701558691),a=this.gg(a,i,l,s,t[10],9,38016083),s=this.gg(s,a,i,l,t[15],14,-660478335),l=this.gg(l,s,a,i,t[4],20,-405537848),i=this.gg(i,l,s,a,t[9],5,568446438),a=this.gg(a,i,l,s,t[14],9,-1019803690),s=this.gg(s,a,i,l,t[3],14,-187363961),l=this.gg(l,s,a,i,t[8],20,1163531501),i=this.gg(i,l,s,a,t[13],5,-1444681467),a=this.gg(a,i,l,s,t[2],9,-51403784),s=this.gg(s,a,i,l,t[7],14,1735328473),l=this.gg(l,s,a,i,t[12],20,-1926607734),i=this.hh(i,l,s,a,t[5],4,-378558),a=this.hh(a,i,l,s,t[8],11,-2022574463),s=this.hh(s,a,i,l,t[11],16,1839030562),l=this.hh(l,s,a,i,t[14],23,-35309556),i=this.hh(i,l,s,a,t[1],4,-1530992060),a=this.hh(a,i,l,s,t[4],11,1272893353),s=this.hh(s,a,i,l,t[7],16,-155497632),l=this.hh(l,s,a,i,t[10],23,-1094730640),i=this.hh(i,l,s,a,t[13],4,681279174),a=this.hh(a,i,l,s,t[0],11,-358537222),s=this.hh(s,a,i,l,t[3],16,-722521979),l=this.hh(l,s,a,i,t[6],23,76029189),i=this.hh(i,l,s,a,t[9],4,-640364487),a=this.hh(a,i,l,s,t[12],11,-421815835),s=this.hh(s,a,i,l,t[15],16,530742520),l=this.hh(l,s,a,i,t[2],23,-995338651),i=this.ii(i,l,s,a,t[0],6,-198630844),a=this.ii(a,i,l,s,t[7],10,1126891415),s=this.ii(s,a,i,l,t[14],15,-1416354905),l=this.ii(l,s,a,i,t[5],21,-57434055),i=this.ii(i,l,s,a,t[12],6,1700485571),a=this.ii(a,i,l,s,t[3],10,-1894986606),s=this.ii(s,a,i,l,t[10],15,-1051523),l=this.ii(l,s,a,i,t[1],21,-2054922799),i=this.ii(i,l,s,a,t[8],6,1873313359),a=this.ii(a,i,l,s,t[15],10,-30611744),s=this.ii(s,a,i,l,t[6],15,-1560198380),l=this.ii(l,s,a,i,t[13],21,1309151649),i=this.ii(i,l,s,a,t[4],6,-145523070),a=this.ii(a,i,l,s,t[11],10,-1120210379),s=this.ii(s,a,i,l,t[2],15,718787259),l=this.ii(l,s,a,i,t[9],21,-343485551),e[0]=this.add32(i,e[0]),e[1]=this.add32(l,e[1]),e[2]=this.add32(s,e[2]),e[3]=this.add32(a,e[3])}md51(e){var t=e.length,i=[1732584193,-271733879,-1732584194,271733878];let a;for(a=64;a<=e.length;a+=64)this.md5cycle(i,this.md5blk(e.substring(a-64,a)));e=e.substring(a-64);let s=new Array(16).fill(0);for(a=0;a<e.length;a++)s[a>>2]|=e.charCodeAt(a)<<(a%4<<3);return s[a>>2]|=128<<(a%4<<3),55<a&&(this.md5cycle(i,s),s=new Array(16).fill(0)),s[14]=8*t,this.md5cycle(i,s),i}md5blk(t){var i=[];for(let e=0;e<64;e+=4)i[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return i}rhex(t){let i="";for(let e=0;e<4;e++)i+=this.hex_chr[t>>8*e+4&15]+this.hex_chr[t>>8*e&15];return i}hex(t){for(let e=0;e<t.length;e++)t[e]=this.rhex(t[e]);return t.join("")}hash(e){return this.hex(this.md51(e))}}class iDatePicker{constructor(e="en",t="YYYY-MM-DD"){this.lang=e,this.dateFormat=t,this.calendarElement,this.currentDate=new Date,this.selectedDate,this.activeInputElement,document.body.addEventListener("click",e=>{!this.calendarElement||e.target.closest(".idatepicker")||e.target.closest("div.idatepicker-calendar")||"idatepicker-prev-month"===e.target.id||"idatepicker-next-month"===e.target.id||this.hideCalendar()})}render(e){e=document.querySelectorAll(e);e&&e.forEach(e=>{e.classList.contains("idatepicker")||(e.type="text",e.classList.add("idatepicker"),e.addEventListener("focus",()=>this.onFocusInput(e)))})}onFocusInput(e){var t=e.value;t&&this.isValidDateFormat(t)?(this.currentDate=this.parseDate(t),this.selectedDate=new Date(this.currentDate)):(this.currentDate=new Date,this.selectedDate),this.activeInputElement=e,this.showCalendar(e)}showCalendar(e){this.calendarElement&&this.calendarElement.remove(),this.calendarElement=this.createElement("div",{position:"absolute",backgroundColor:"#fff",fontSize:"12px",padding:"8px",border:"2px solid #e6e6e6",borderRadius:"4px",boxSizing:"border-box",marginTop:"2px",zIndex:"100"},"idatepicker-calendar"),document.body.appendChild(this.calendarElement);e=e.getBoundingClientRect();this.calendarElement.style.top=e.bottom+window.scrollY+"px",this.calendarElement.style.left=e.left+window.scrollX+"px",this.buildCalendar()}hideCalendar(){this.calendarElement&&(this.calendarElement.remove(),this.calendarElement)}buildCalendar(){var e=this.currentDate.getFullYear(),t=this.currentDate.getMonth(),i=(this.calendarElement.innerHTML="",this.createHeader()),e=this.createCalendarTable(e,t);this.calendarElement.appendChild(i),this.calendarElement.appendChild(e)}createHeader(){var e=this.createElement("div",{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"5px 0px 10px 0px"}),t=this.createButton("🞀","idatepicker-prev-month",()=>this.changeMonth(-1)),i=this.createElement("span",{fontSize:"15px",fontWeight:"bold"}),a=(i.textContent=this.currentDate.toLocaleString("en"===this.lang?"en":"zh",{month:"short"})+" / "+this.currentDate.getFullYear(),this.createButton("🞂","idatepicker-next-month",()=>this.changeMonth(1)));return e.appendChild(t),e.appendChild(i),e.appendChild(a),e}createButton(e,t,i){var a=this.createElement("button",{position:"relative",backgroundColor:"#2ca4e9",fontSize:"12px",color:"#fff",padding:"3px 6px",border:"none",borderRadius:"3px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)",boxSizing:"border-box",cursor:"pointer"});return a.type="button",a.id=t,a.textContent=e,a.addEventListener("click",e=>{e.preventDefault(),i()}),a}changeMonth(e){this.currentDate.setMonth(this.currentDate.getMonth()+e),this.buildCalendar()}createCalendarTable(e,t){var i=this.createElement("table",{width:"100%",borderCollapse:"collapse"}),a=this.createTableHeader(),e=this.createTableBody(e,t);return i.appendChild(a),i.appendChild(e),i}createTableHeader(){var e=document.createElement("thead");const i=document.createElement("tr");return("en"===this.lang?["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]:["日","一","二","三","四","五","六"]).forEach(e=>{var t=this.createElement("th",{width:"36px",height:"28px",fontSize:"12px",color:"#2ca4e9",padding:"4px",border:"2px solid #e6e6e6",boxSizing:"border-box",textAlign:"center"});t.textContent=e,i.appendChild(t)}),e.appendChild(i),e}createTableBody(a,s){var e=document.createElement("tbody"),l=new Date(a,s,1).getDay(),r=new Date(a,s+1,0).getDate();let n=new Date(a,s,0).getDate()-l+1,o=1,d=1;for(let i=0;i<6;i++){var c,u,p=document.createElement("tr");for(let t=0;t<7;t++){let e;e=0===i&&t<l?(c=this.formatDate(new Date(a,s-1,n++)),this.createDateCell(n-1,c,!0)):o>r?(c=this.formatDate(new Date(a,s+1,d)),this.createDateCell(d++,c,!0)):(u=this.formatDate(new Date(a,s,o)),this.createDateCell(o++,u,!1)),p.appendChild(e)}e.appendChild(p)}return e}createDateCell(e,t,i){i=this.createElement("td",{backgroundColor:this.selectedDate&&t===this.formatDate(this.selectedDate)?"#2ca4e9":"",width:"36px",height:"28px",fontSize:"12px",color:i?"#aaa":this.selectedDate&&t===this.formatDate(this.selectedDate)?"#fff":"",padding:"4px",border:"2px solid #e6e6e6",boxSizing:"border-box",textAlign:"center",cursor:"pointer"});return i.dataset.date=t,i.textContent=e,i.addEventListener("click",()=>this.onDateSelect(t)),i}onDateSelect(e){e=this.parseDate(e);isNaN(e)||(this.activeInputElement.value=this.formatDate(e),this.activeInputElement.dispatchEvent(new Event("input")),this.selectedDate=e,this.buildCalendar(),this.hideCalendar())}createElement(e,t={},i){e=document.createElement(e);return i&&(e.className=i),Object.assign(e.style,t),e}isValidDateFormat(e){let t;return(t="DD/MM/YYYY"===this.dateFormat.toString().toUpperCase()?/^(0[1-9]|[12][0-9]|3[01])\/(0[1-9]|1[0-2])\/\d{4}$/:/^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$/).test(e)}parseDate(e){var[e,t,i]="DD/MM/YYYY"===this.dateFormat.toString().toUpperCase()?e.split("/").map(Number).reverse():e.split("-").map(Number);return new Date(e,t-1,i)}formatDate(e){var t=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),e=String(e.getDate()).padStart(2,"0");return"DD/MM/YYYY"===this.dateFormat.toString().toLowerCase()?e+"/"+i+"/"+t:t+"-"+i+"-"+e}}class iPagination{constructor(e,t){this.settings=Object.assign({mode:1,size:5,total:1,placeholder:""},t),this.currentPage=1,this.url=new URL(window.location.href),this.searchParams=new URLSearchParams(this.url.search),this.searchParams.has("page")&&(this.currentPage=Math.max(parseInt(this.searchParams.get("page")),1)),this.searchParams.delete("page"),this.baseUrl=this.url.origin+this.url.pathname+"?"+this.searchParams.toString(),this.renderPagination(e)}createPageUrl(e){return(this.baseUrl+"&page="+e).replace("?&","?")}jumpToPage(t){t.addEventListener("keypress",e=>{13===e.which&&(e=Math.min(Math.max(parseInt(t.value)||1,1),t.getAttribute("data-max")),window.location.href=this.createPageUrl(e))})}createPaginationElement(e,t="",i=""){e=document.createElement(e);return t&&(e.className=t),i&&(e.innerHTML=i),e}renderPagination(e){if(!e.querySelector(".iweb-pagination")){var a=e.getAttribute("data-size")||this.settings.size,s=e.getAttribute("data-totalpage")||this.settings.total,l=Math.max(this.currentPage-1,1),r=Math.min(this.currentPage+1,s),n=s,o=Math.floor(a/2);let t=Math.max(this.currentPage-o,1),i=Math.min(this.currentPage+o,n);if(i-t+1<a&&(this.currentPage<1+o?i=Math.min(n,t+a-1):t=Math.max(1,i-a+1)),1<s){var a=this.createPaginationElement("div","iweb-pagination"),d=this.createPaginationElement("ul"),c=this.createPaginationElement("a","first",2===this.settings.mode&&this.currentPage>o?"<span>1..</span>":"<i></i><i></i>"),u=(c.href=this.createPageUrl(1),c.title="First Page",this.createPaginationElement("li")),c=(u.appendChild(c),d.appendChild(u),this.createPaginationElement("a","prev","<i></i>")),u=(c.href=this.createPageUrl(l),c.title="Previous Page",this.createPaginationElement("li"));u.appendChild(c),d.appendChild(u);for(let e=t;e<=i;e++){var p=this.createPaginationElement("a","num"+(e===this.currentPage?" current":""),"<span>"+e+"</span>"),h=(p.href=this.createPageUrl(e),this.createPaginationElement("li"));h.appendChild(p),d.appendChild(h)}l=this.createPaginationElement("a","next","<i></i>"),c=(l.href=this.createPageUrl(r),l.title="Next Page",this.createPaginationElement("li")),u=(c.appendChild(l),d.appendChild(c),this.createPaginationElement("a","last",2===this.settings.mode&&this.currentPage<s-o?"<span>.."+n+"</span>":"<i></i><i></i>")),r=(u.href=this.createPageUrl(n),u.title="Last Page",this.createPaginationElement("li")),l=(r.appendChild(u),d.appendChild(r),this.createPaginationElement("li")),c=this.createPaginationElement("input","jumpto_page");c.type="text",c.placeholder=this.settings.placeholder,c.setAttribute("data-max",s),this.jumpToPage(c),l.appendChild(c),d.appendChild(l),a.appendChild(d),e.appendChild(a)}}}}